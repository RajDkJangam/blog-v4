<!doctype html>
<html amp lang="en">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>Lazy Loading Css to drastically Improve Page Speed</title>
    <link rel="canonical" href="https://blog.webjeda.com/lazy-load-css/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <style amp-custom>
        
        a{color:#00953e}a:hover{color:#eee;background-color:#00953e;text-decoration:none}a:focus,a:active{color:#eee;background-color:#ea2626;text-decoration:none}.container{max-width:600px;margin:0 auto;font-family:-apple-system,".SFNSText-Regular","San Francisco","Roboto","Segoe UI","Helvetica Neue","Lucida Grande",Arial,sans-serif;color:rgba(0,0,0,0.7);line-height:1.5}.main-content{margin:0 10px}amp-img{max-width:100%}header{padding:1em 0em 0em 0em}header img{height:50px}header a{text-decoration:none}header a:hover,header a:focus,header a:active{text-decoration:none;border:none;background-color:transparent}footer{text-align:center;padding:1em;background:#000;color:#eee;font-family:-apple-system,".SFNSText-Regular","San Francisco","Roboto","Segoe UI","Helvetica Neue","Lucida Grande",Arial,sans-serif}footer a{color:#eee}.date{color:#828282}.video{width:100%;height:515px}@media screen and (max-width: 600px){.video{height:250px}}.text-center{text-align:center}a .btn{background-color:transparent;border:1px solid #0a5;border-radius:2px;padding:10px 25px;cursor:pointer}a .btn:hover{background-color:#0a5;color:#eee}blockquote{border-left:5px solid #00953e;padding-left:1em;font-style:italic;font-size:1.8em}#markdown-toc::before{content:"Contents";font-weight:bold;line-height:1.8;font-size:20px}#markdown-toc ul{list-style:decimal}#markdown-toc{font-family:-apple-system,".SFNSText-Regular","San Francisco","Roboto","Segoe UI","Helvetica Neue","Lucida Grande",Arial,sans-serif;font-size:15.5px;border:1px solid #757575;padding:1.5em;padding-left:2em;list-style:decimal;display:inline-block;margin-right:2em}#markdown-toc a{text-decoration:none;border:none;color:cornflowerblue}#markdown-toc a:hover{color:rgba(0,0,0,0.7);background-color:transparent}@media screen and (max-width: 600px){#markdown-toc{float:none;margin-right:0}}.highlighter-rouge{font-size:15.5px;border:1px solid #e8e8e8;border-radius:4px;padding:2px 10px}@media screen and (max-width: 600px){.highlighter-rouge{font-size:10.85px}}.highlight{background:#fff;padding:5px 20px;border-radius:5px;box-shadow:inset 0 0 10px #f9f9f9, inset 0 0 15px #eaeaea;margin:0;font-size:15.5px}@media screen and (max-width: 600px){.highlight{font-size:10.85px;padding:5px 10px}}.highlight code,.highlight pre{border:none;box-shadow:none;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#555}.highlight .gd .x{color:#555}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#555}.highlight .gi .x{color:#555}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#4747f5}.highlight .nb{color:#0086B3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#4747f5}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#5e5ee6}.highlight .nv{color:#4747f5}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:#4747f5}.highlight .vg{color:#4747f5}.highlight .vi{color:#4747f5}.highlight .il{color:#099}

        
        
      </style>
    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    
  
    <!-- Open Graph -->
    <meta property="fb:app_id" content="549480635219583">
    <meta property="og:locale" content="en_US">
    <meta property="og:title" content="Lazy Loading Css to drastically Improve Page Speed">
    <meta property="og:url" content="https://blog.webjeda.com/lazy-load-css/">
    <meta property="og:site_name" content="WebJeda Blog">
    <meta property="og:description" content="Loading big CSS file at the end of the document makes sense because some times CSS takes up a lot of time to load. Learn how to defer CSS loading which makes your website super-fast. PageSpeed is a tool by Google where you can find the website speed.">
    <meta property="og:type" content="article">
    <meta property="og:image" content="https://blog.webjeda.com/thumbs/lazy-load-css-for-fast-website.jpg" />
    <meta property="og:image:alt" content="Lazy Loading Css to drastically Improve Page Speed" />
    <meta property="article:publisher" content="http://www.facebook.com/webjeda" />
    <meta property="article:author" content="https://www.facebook.com/sharu725" />
    <meta property="article:published_time" content="2016-02-03 00:00:00 +0530" />


   <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="Lazy Loading Css to drastically Improve Page Speed">
    <meta name="twitter:description" content="Loading big CSS file at the end of the document makes sense because some times CSS takes up a lot of time to load. Learn how to defer CSS loading which makes your website super-fast. PageSpeed is a tool by Google where you can find the website speed.">
    <meta name="twitter:site" content="@webjeda" />
    <meta name="twitter:creator" content="@sharathdt">
    <meta name="twitter:card" content="summary">

    <!-- Schema -->
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "TechArticle",
        "name": "Lazy Loading Css to drastically Improve Page Speed",
        "headline": "Lazy Loading Css to drastically Improve Page Speed",
        "image": "https://blog.webjeda.com/thumbs/lazy-load-css-for-fast-website.jpg",
        "description": "Loading big CSS file at the end of the document makes sense because some times CSS takes up a lot of time to load. Learn how to defer CSS loading which makes your website super-fast. PageSpeed is a tool by Google where you can find the website speed.",
        "url": "https://blog.webjeda.com/lazy-load-css/",
        "datePublished": "2016-02-03",
         "author": {
          "@type": "Person",
          "name": "sharath.dt"
        }
      }
    </script>
    
    <!-- Disqus comments -->
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
    
  </head>
  
<body>
<div class="container">
<div class="main-content">
<header>
    <a href="https://blog.webjeda.com"><amp-img width="580" height="90" layout="responsive" src="/img/webjeda-logo-x50.svg" alt="WebJeda Blog | A modern web development blog"></amp-img></a>
</header>
<h1 class="post-title">Lazy Loading Css to drastically Improve Page Speed</h1>
<p class="date"><small>03 Feb 2016 - sharathdt</small></p>    
<amp-img src="https://blog.webjeda.com/thumbs/lazy-load-css-for-fast-website.jpg" alt="Lazy Loading Css to drastically Improve Page Speed" width="600" height="375" layout="responsive"><noscript><img src="https://blog.webjeda.com/thumbs/lazy-load-css-for-fast-website.jpg" alt="Lazy Loading Css to drastically Improve Page Speed" width="600" height="375"></noscript></amp-img>

<p class="intro">Loading big CSS file at the end of the document makes sense because some times CSS takes up a lot of time to load. Learn how to defer CSS loading which makes your website super-fast. PageSpeed is a tool by Google where you can find the website speed.</p>

<h2 class="clear" id="why-lazy-load-css">Why lazy load css?</h2>
<p>Along with loading JavaScript at the end of the document, you should also load big css files at the end. This makes your website super-fast. Because the main content loads first. So even on a slow connection, the content will be available for the user. And also faster the website SEO friendly it is.</p>

<ul id="markdown-toc">
  <li><a href="#why-lazy-load-css" id="markdown-toc-why-lazy-load-css">Why lazy load css?</a></li>
  <li><a href="#how-to-load-css-at-the-end" id="markdown-toc-how-to-load-css-at-the-end">How to load CSS at the end?</a></li>
  <li><a href="#problems-i-faced-while-lazy-loading-css" id="markdown-toc-problems-i-faced-while-lazy-loading-css">Problems I faced while lazy loading css</a></li>
  <li><a href="#inline-critical-css" id="markdown-toc-inline-critical-css">Inline critical CSS</a></li>
  <li><a href="#inline-scss-in-jekyll" id="markdown-toc-inline-scss-in-jekyll">Inline SCSS in Jekyll</a></li>
</ul>

<p>Many a times - on a slow connection - a user may wait for a maximum of 5 to 6 seconds and if the website is blank and still busy loading your <strong>head tag</strong> with a huge <code class="highlighter-rouge">css</code> file, the user may hit the back button!</p>

<p>You just lost a potential subscriber or even customer if you are selling something. Using a pre-loader like I did on <a href="http://webjeda.com" target="_blank">my website</a> can engage the users for a few more seconds but not forever. So you should not make your users wait for the main content.</p>

<p>In this method of lazy loading css, the content loads without any style and then the stylesheet loads followed by JavaScript. You may have observed this while browsing my website. This is important for a user with a slow connection. Content(visible stuff) should load at the very beginning. Style(css) and scripts(js) can wait.</p>

<p>This ensures that even if the style or script fails to load, the user can still read the content (if the content is text). You can also <a href="/compress-html-jekyll/" target="_blank">minify your blog for faster loading</a>.</p>

<p>What I did was, I put a script at the end of the html document to insert the css <strong>link tag</strong> only after loading the document. This was helpful because my <code class="highlighter-rouge">main.css</code> is a huge file and also font awesome stylesheet that loads from a CDN.</p>

<amp-ad type="adsense" width="336" height="280" class="adclass adsbygoogle" data-ad-client="ca-pub-4146856286076977" data-ad-slot="9695384645"></amp-ad>

<p>After testing in <a href="https://developers.google.com/speed/pagespeed/insights/" rel="nofollow" target="_blank">PageSpeed</a> I found that my website is faster than ever! Do use this tool to find out what is slowing down your website.</p>

<p>Another very good tool to analyze website loading time is <a href="https://gtmetrix.com/" rel="nofollow" target="_blank">GT Metrix</a>. This tool will give you a deep analysis on why your website is slow and provides optimized files to use.</p>

<h2 id="how-to-load-css-at-the-end">How to load CSS at the end?</h2>

<p>This is possible if I declare my link tag at the end of the document. But it is advised by w3c to place link tags only in the head section. So I’m using a script to place the link tag( linking css) in the head section.</p>

<p>I suggest you to check the <a href="https://developers.google.com/speed/pagespeed/insights/" rel="nofollow" target="_blank">PageSpeed Insights</a> before and after implementing this. You sure will notice the difference.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;noscript&gt;</span>
      <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"/css/main.css"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"/font-awesome/css/font-awesome.min.css"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/noscript&gt;</span>


<span class="nt">&lt;script&gt;</span>
    <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">font</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'link'</span><span class="p">);</span> 
        <span class="kd">var</span> <span class="nx">font2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'link'</span><span class="p">);</span> 
        <span class="nx">font</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'text/css'</span><span class="p">;</span> 
        <span class="nx">font2</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'text/css'</span><span class="p">;</span> 
        <span class="nx">font</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s1">'stylesheet'</span><span class="p">;</span>
        <span class="nx">font2</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s1">'stylesheet'</span><span class="p">;</span>
        <span class="nx">font</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">'/css/main.css'</span><span class="p">;</span>
        <span class="nx">font2</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">'https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css'</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'link'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> 
        <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'link'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> 
        <span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">font</span><span class="p">,</span> <span class="nx">s</span><span class="p">);</span>
        <span class="nx">t</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">font2</span><span class="p">,</span> <span class="nx">t</span><span class="p">);</span>
      <span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span></code></pre></figure>

<p>The above code loads two CSS files. One is local <code class="highlighter-rouge">main.css</code> and the other is remote <code class="highlighter-rouge">font-awesome.min.css</code>. You can make use of this code and change it accordingly. Make sure you edit the path properly.</p>

<p>Keep contents within <code class="highlighter-rouge">&lt;noscript&gt;</code> tag in the head file. This will be loaded only of the website is loaded in a browser which doesn’t run any script or with a <strong>noscript</strong> plugin.</p>

<h2 id="problems-i-faced-while-lazy-loading-css">Problems I faced while lazy loading css</h2>

<p>This problem occurred because I have Adsense. My AdSense code is responsive. It adjusts to the screen size mentioned in the media query. And the media query is inside <code class="highlighter-rouge">main.css</code> which I have made to load at the very end!</p>

<p>Adsense script loads before <code class="highlighter-rouge">main.css</code> and assumes that the screen is full width whereas my content is not full width. My content only goes in the center leaving some gap on both left and right sides. But AdSense has already assumed that it is full screen and adjusts its ad size to full screen and hence the ad flows out of the content.</p>

<h2 id="inline-critical-css">Inline critical CSS</h2>

<p>I struggled hard to tackle this. And after a while, I realized that I can define the width of my content with inline-css even before the AdSense code loads! Thus avoiding it to overflow. You can inline any style that you think is required in the beginning.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"container"</span> <span class="na">style=</span><span class="s">"max-width:730px;padding: 0 1.5rem;margin: 0 auto;"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;main&gt;</span>
         {{ content }}
        <span class="nt">&lt;/main&gt;</span>
  <span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>So that solved the problem :) You can in-line important css this way. When the css file is made to load at the end, your content will not have any styling which means the content may show up on the left side of the screen for a fraction of a second, fonts appear with a default web-font and some SVGs and images may show up in their full size.</p>

<amp-ad type="adsense" width="336" height="280" class="adclass2 adsbygoogle" data-ad-client="ca-pub-4146856286076977" data-ad-slot="8755205041"></amp-ad>

<p>To avoid this, in-line some of the css which makes everything look smooth. Do not in-line too much css though. It is not a good practice and also your users shouldn’t get an impression that you do not know how to use css.</p>

<h2 id="inline-scss-in-jekyll">Inline SCSS in Jekyll</h2>
<p>Jekyll supports sass preprocessor. So any number of <code class="highlighter-rouge">scss</code> files can be used to make a single <code class="highlighter-rouge">main.scss</code> file which in turn generates a <code class="highlighter-rouge">main.css</code> file upon build.</p>

<p>And also, Jekyll supports linking <code class="highlighter-rouge">scss</code> file directly inside html and can be changed to <code class="highlighter-rouge">css</code> file using scssify filter.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">  <span class="nt">&lt;style&gt;</span>
          <span class="p">{</span><span class="err">%</span> <span class="err">capture</span> <span class="err">include_to_scssify</span> <span class="err">%</span><span class="p">}</span>
          <span class="p">{</span><span class="err">%</span> <span class="err">include</span> <span class="err">critical.scss</span> <span class="err">%</span><span class="p">}</span>
          <span class="p">{</span><span class="err">%</span> <span class="err">endcapture</span> <span class="err">%</span><span class="p">}</span>
          <span class="p">{</span><span class="err">{</span> <span class="err">include_to_scssify</span> <span class="err">|</span> <span class="err">scssify</span> <span class="p">}</span><span class="err">}</span>
  <span class="nt">&lt;/style&gt;</span></code></pre></figure>

<p>But remember, the scss file you want to include should be inside <strong>_includes</strong> folder.</p>

<p>I hope this article has helped you to speed up your website. Let me know how it went. Leave a comment if you have any suggestion. I would be happy to implement it.</p>

<p>Thanks for reading!</p>


<p class="text-center">
<a href="https://blog.webjeda.com/lazy-load-css/#disqus_thread"><button class="btn">View/Add comments</button></a>
</p>
</div>
<footer>
    © copyrights by <a href="https://blog.webjeda.com">webjeda</a>
</footer>
</div>

<amp-analytics type="googleanalytics">
<script type="application/json">
{
  "vars": {
    "account": "UA-71358787-1"
  },
  "triggers": {
    "trackPageview": {
      "on": "visible",
      "request": "pageview"
    }
  }
}
</script>
</amp-analytics>
</body>

</html>